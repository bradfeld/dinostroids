var ue="@vercel/analytics",fe="1.5.0",ge=()=>{window.va||(window.va=function(...n){(window.vaq=window.vaq||[]).push(n)})};function j(){return typeof window<"u"}function Z(){try{let e="production";if(e==="development"||e==="test")return"development"}catch{}return"production"}function me(e="auto"){if(e==="auto"){window.vam=Z();return}window.vam=e}function we(){return(j()?window.vam:Z())||"production"}function _(){return we()==="development"}function ye(e){return e.scriptSrc?e.scriptSrc:_()?"https://va.vercel-scripts.com/v1/script.debug.js":e.basePath?`${e.basePath}/insights/script.js`:"/_vercel/insights/script.js"}function J(e={debug:!0}){var n;if(!j())return;me(e.mode),ge(),e.beforeSend&&((n=window.va)==null||n.call(window,"beforeSend",e.beforeSend));let i=ye(e);if(document.head.querySelector(`script[src*="${i}"]`))return;let s=document.createElement("script");s.src=i,s.defer=!0,s.dataset.sdkn=ue+(e.framework?`/${e.framework}`:""),s.dataset.sdkv=fe,e.disableAutoTrack&&(s.dataset.disableAutoTrack="1"),e.endpoint?s.dataset.endpoint=e.endpoint:e.basePath&&(s.dataset.endpoint=`${e.basePath}/insights`),e.dsn&&(s.dataset.dsn=e.dsn),s.onerror=()=>{let c=_()?"Please check if any ad blockers are enabled and try again.":"Be sure to enable Web Analytics for your project and deploy again. See https://vercel.com/docs/analytics/quickstart for more information.";console.log(`[Vercel Web Analytics] Failed to load script from ${i}. ${c}`)},_()&&e.debug===!1&&(s.dataset.debug="false"),document.head.appendChild(s)}J();var r=document.getElementById("gameCanvas"),t=r.getContext("2d");r.width=window.innerWidth;r.height=window.innerHeight;var k=Math.PI*2;var xe=15,pe=.07*3,P=.18*3,Se=.98,ie=3e3,Te=2,Ae=8,ve=50,B=120,F=.6*3,N=1.6*3,ne={large:45,medium:25,small:15},Y={easy:{large:{min:1.5,max:3},medium:{min:2.4,max:4.5},small:{min:3.6,max:6}},medium:{large:{min:2.4,max:4.5},medium:{min:3.6,max:6},small:{min:5.4,max:7.5}},difficult:{large:{min:3.6,max:6},medium:{min:5.4,max:7.5},small:{min:7.5,max:10.5}}},oe=10,p={easy:{playerAcceleration:P,shootCooldown:B,asteroidMinSpeed:F,asteroidSpeedVariation:N,initialAsteroidCountBase:2,lives:5},medium:{playerAcceleration:P*1.5,shootCooldown:Math.floor(B*.7),asteroidMinSpeed:F*1.5,asteroidSpeedVariation:N*1.2,initialAsteroidCountBase:3,lives:3},difficult:{playerAcceleration:P*2,shootCooldown:Math.floor(B*.5),asteroidMinSpeed:F*2,asteroidSpeedVariation:N*1.5,initialAsteroidCountBase:4,lives:2}},L="medium",Ee=p.medium.playerAcceleration,re=p.medium.shootCooldown,Ie=p.medium.asteroidMinSpeed,be=p.medium.asteroidSpeedVariation,ke=p.medium.initialAsteroidCountBase,K=p.medium.lives,V={BIG:"BIG",MEDIUM:"MEDIUM",LITTLE:"LITTLE"},Ne={[V.BIG]:{baseSize:45,score:20},[V.MEDIUM]:{baseSize:25,score:50},[V.LITTLE]:{baseSize:15,score:100}};var Q={small:"./images/bront.png",medium:"./images/steg.png",large:"./images/trex.png"},se={small:null,medium:null,large:null};function Pe(e){console.log("Preloading dinosaur images...");let n=0,i=Object.keys(Q).length,s=()=>{console.log("All dinosaur images loaded successfully!"),e&&e()},c=a=>{console.log(`${a} dinosaur image loaded.`),n++,n===i&&s()},l=(a,u)=>{console.error(`Error loading ${a} dinosaur image:`,u),n++,n===i&&s()};Object.entries(Q).forEach(([a,u])=>{let m=new Image;m.onload=()=>c(a),m.onerror=I=>l(a,I),m.src=u,se[a]=m})}function ee(e){if(!e||e.length===0)return"";let n=`M ${e[0].x} ${e[0].y}`;for(let i=1;i<e.length;i++)n+=` L ${e[i].x} ${e[i].y}`;return n+=" Z",n}var Ye={small:`<svg viewBox="-1.1 -0.9 2.2 1.8" width="2.2" height="1.8">
              <path fill="none" stroke="currentColor" stroke-width="0.1" stroke-linecap="round" stroke-linejoin="round"
                    d="${ee([{x:.8,y:-.6},{x:1,y:-.4},{x:.9,y:0},{x:.5,y:.3},{x:.2,y:.8},{x:-.5,y:.7},{x:-1,y:.5},{x:-.8,y:0},{x:-.9,y:-.3},{x:-.4,y:-.6},{x:0,y:-.7},{x:.3,y:-.6},{x:.6,y:-.8}])}" />
            </svg>`,large:`<svg viewBox="-1.1 -0.9 2.1 1.9" width="2.1" height="1.9">
               <path fill="none" stroke="currentColor" stroke-width="0.1" stroke-linecap="round" stroke-linejoin="round"
                     d="${ee([{x:.5,y:-.9},{x:.9,y:-.7},{x:.6,y:-.2},{x:.9,y:.1},{x:.5,y:.3},{x:.4,y:.8},{x:-.3,y:.9},{x:-.8,y:.6},{x:-1,y:0},{x:-.8,y:-.3},{x:-.9,y:-.6},{x:-.7,y:-.7},{x:-.3,y:-.8},{x:.2,y:-.3},{x:.3,y:-.5},{x:.1,y:-.8}])}" />
            </svg>`,medium:`<svg width="3.999" height="1.267" viewBox="0 0 3.999 1.267" xmlns="http://www.w3.org/2000/svg">
                <path fill="none" stroke="currentColor" stroke-width="0.015" stroke-linecap="round" stroke-linejoin="round"
                      d="m2.197 0-.064.04-.02.026-.06.093-.07.023-.2-.039-.033.004-.07.034-.186.08-.338.125-.098.085-.026.043L.82.61.598.705.453.75.341.761.2.776.01.79 0 .793l.04.023.249.068.284.049.214-.015.142-.01.24-.018.054-.008.05.01.025.044.015.077-.045.109-.037.1.045.042.37.001h.023l.03-.037-.02-.032-.01-.018-.01-.05.123-.106.019.037.022.056.042.104.052.048.345-.002.05-.007-.056-.098-.058-.118.038-.037h.25l.04-.008.03.052.078.128.126.064.223-.011h.104l.04-.008-.19-.2-.037-.044.032-.084.049-.029.178-.01.023-.004.152-.016.217.037.15.047.1-.018.01-.008.11-.139.002-.015L3.86.662 3.758.6l.24-.214-.105.01-.28.073-.062.003.17-.317-.045.004-.132.065-.193.09-.074.032-.031-.061-.17-.117-.167-.09L2.8.03 2.534.017l-.282-.01L2.24.004zm-.022.024.184.02.059.005.16.009h.056l.164.01.092.044.083.044.21.124.047.077.065.023.183-.086.135-.058-.025.073-.08.149.012.067.362-.094-.02.024-.132.112.035.087.118.112-.002.01-.12.14-.012.005-.138-.043L3.378.82l-.12.014-.026.005-.258.023-.068.03-.043.099.02.054.06.066.084.09.007.021-.123.003h-.18l-.042-.017-.063-.12-.07-.105-.064-.012-.047.004h-.252l-.043.029.062.157.02.054-.032.02h-.249l-.043-.035-.08-.183L1.8.964 1.76.986l-.105.087-.054.048.013.046.012.021-.046.038h-.3l.017-.055.058-.13-.021-.132-.008-.012L1.3.854h-.106l-.07.008-.226.02H.894l-.258.02L.34.864.188.819.176.81l.078-.01.235-.025.135-.039L.9.616l.155-.067.04-.054.1-.084.348-.13.21-.093.06-.006.198.037.06-.016.102-.154z" />
             </svg>`},o={x:r.width/2,y:r.height/2,angle:-Math.PI/2,speed:0,rotationSpeed:pe,acceleration:P,friction:Se,size:xe,canShoot:!0,lastShotTime:0,isInvulnerable:!1},d=[],h=[],y=0,v=3,T=1,R=!0;var w=!1,g=!1,f=null,x=null,q=!1,b=0,H=class{constructor(n,i,s){this.sizeType=n,this.x=i,this.y=s,this.radius=ne[this.sizeType],this.size=this.radius,this.speed=Math.random()*(Y[L][this.sizeType].max-Y[L][this.sizeType].min)+Y[L][this.sizeType].min,this.angle=Math.random()*k,this.rotation=Math.random()*k,this.rotationSpeed=(Math.random()-.5)*.05,this.image=se[this.sizeType],this.image||console.error(`Image for ${this.sizeType} asteroid not loaded!`)}draw(){if(this.x+this.radius<0||this.x-this.radius>r.width||this.y+this.radius<0||this.y-this.radius>r.height)return;t.save(),t.translate(this.x,this.y),t.rotate(this.rotation);let n=this.radius*2/Math.max(this.image?.width||100,this.image?.height||100);this.image&&this.image.complete?t.drawImage(this.image,-this.image.width*n/2,-this.image.height*n/2,this.image.width*n,this.image.height*n):(t.beginPath(),t.arc(0,0,this.radius,0,k),t.strokeStyle="gray",t.lineWidth=1,t.stroke()),t.restore()}update(){this.x+=Math.cos(this.angle)*this.speed,this.y+=Math.sin(this.angle)*this.speed,this.rotation+=this.rotationSpeed,X(this)}},G=class{constructor(n,i,s){this.x=n,this.y=i,this.angle=s,this.speed=Ae,this.radius=Te,this.size=this.radius,this.lifespan=ve}draw(){this.x<-this.radius||this.x>r.width+this.radius||this.y<-this.radius||this.y>r.height+this.radius||(t.beginPath(),t.arc(this.x,this.y,this.radius,0,k),t.fillStyle="white",t.fill())}update(){return this.x+=Math.cos(this.angle)*this.speed,this.y+=Math.sin(this.angle)*this.speed,this.lifespan--,this.lifespan>0&&this.x>=-this.radius&&this.x<=r.width+this.radius&&this.y>=-this.radius&&this.y<=r.height+this.radius}},E={};document.addEventListener("keydown",e=>{if(E[e.key]=!0,e.key==="?"&&(w=!w,e.preventDefault()),!g&&!w){let n=e.key.toLowerCase(),i=null;n==="e"?i="easy":n==="m"?i="medium":n==="d"&&(i="difficult"),i&&($e(i),Re(),e.preventDefault())}e.key==="Escape"&&g&&!w&&(R&&ae(),e.preventDefault())});document.addEventListener("keyup",e=>{E[e.key]=!1});function X(e){let n=typeof e.radius<"u"?e.radius:e.size;e.x<-n&&(e.x=r.width+n),e.x>r.width+n&&(e.x=-n),e.y<-n&&(e.y=r.height+n),e.y>r.height+n&&(e.y=-n)}function U(e="large",n=null,i=null){let s=ne[e],c=o.size+s+100;if(n===null||i===null){let a=0;do n=s+Math.random()*(r.width-2*s),i=s+Math.random()*(r.height-2*s),a++;while(a<50&&Math.sqrt(Math.pow(n-o.x,2)+Math.pow(i-o.y,2))<c);a>=50&&console.warn("Could not find a safe spawn location far from the player after 50 attempts. Spawning anyway."),console.log(`Spawning ${e} asteroid randomly inside canvas at (${n.toFixed(1)}, ${i.toFixed(1)})`)}else console.log(`Spawning split ${e} asteroid at provided location (${n.toFixed(1)}, ${i.toFixed(1)})`);let l=new H(e,n,i);h.push(l),console.log(`Asteroids array length: ${h.length}`)}function te(e,n){let i=e.x-n.x,s=e.y-n.y,c=Math.sqrt(i*i+s*s),l=typeof e.radius<"u"?e.radius:e.size,a=typeof n.radius<"u"?n.radius:n.size;return c<l+a}async function ae(){R=!1;let e=y;await W();let n=!1;f&&!x?f.length<oe?n=e>0:n=e>f[f.length-1].score:x&&console.error("Cannot check leaderboard qualification due to fetch error.");let i=null,s=!1,c=null;if(n){for(;;){if(i=prompt(`You made the leaderboard! Score: ${e}
Enter your initials (1-3 characters):`),i===null){i=null;break}if(i=i.trim().toUpperCase(),i.length>0&&i.length<=3)break;alert("Please enter 1 to 3 characters for your initials.")}if(i)try{s=await Le(i,e),s&&await W()}catch(u){c=u.message}}t.fillStyle="rgba(0, 0, 0, 0.85)",t.fillRect(0,0,r.width,r.height),t.fillStyle="white",t.textAlign="center",t.textBaseline="middle";let l=r.width/2,a=r.height/2;t.font="48px Arial",t.fillText("GAME OVER",l,a-150),t.font="30px Arial",t.fillText(`Final Score: ${e}`,l,a-100),t.font="20px Arial",n?i?s?t.fillText("Score submitted to leaderboard!",l,a-60):c?(t.fillText(`Submission Error: ${c}`,l,a-60),t.fillText("Your score was not saved.",l,a-30)):t.fillText("Score qualified, but was not submitted.",l,a-60):t.fillText("You qualified, but did not enter initials.",l,a-60):x?t.fillText("Could not check leaderboard ranking.",l,a-60):t.fillText("Better luck next time!",l,a-60),t.font="20px Arial",t.fillText("Returning to Title Screen...",l,a+150),setTimeout(()=>{ce()},3e3)}async function Le(e,n){console.log(`Submitting score: ${e} - ${n}`);try{let i=await fetch("/api/leaderboard",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({initials:e,score:n})});if(!i.ok){let c=await i.json().catch(()=>({message:"Unknown error"}));throw new Error(`Failed to submit score: ${i.status} ${c.message||""}`)}let s=await i.json();return console.log("Submission result:",s.message),!0}catch(i){throw console.error("Error submitting score:",i),i}}async function M(e){if(w){le(),requestAnimationFrame(M);return}if(!g){$(),requestAnimationFrame(M);return}if(t.clearRect(0,0,r.width,r.height),t.fillStyle="black",t.fillRect(0,0,r.width,r.height),E.ArrowUp?o.speed+=o.acceleration:o.speed*=o.friction,E[" "]&&o.canShoot){let i=o.x+Math.cos(o.angle)*o.size,s=o.y+Math.sin(o.angle)*o.size;d.push(new G(i,s,o.angle)),o.canShoot=!1,o.lastShotTime=e}!o.canShoot&&e-o.lastShotTime>re&&(o.canShoot=!0),o.x+=Math.cos(o.angle)*o.speed,o.y+=Math.sin(o.angle)*o.speed,X(o);for(let i=d.length-1;i>=0;i--)d[i].update()||d.splice(i,1);ze(),t.fillStyle="white",t.font="20px Arial",t.textBaseline="top",t.textAlign="left",t.fillText("Level: "+T,10,10),t.textAlign="center",t.fillText("Score: "+y,r.width/2,10),t.textAlign="right",t.fillText("Lives: "+v,r.width-10,10),Me();for(let i of d)i.draw();let n=[];for(let i of h)n.push(i.draw());try{await Promise.all(n)}catch(i){console.error("Error during asteroid drawing batch:",i)}requestAnimationFrame(M)}function Me(){t.save(),t.translate(o.x,o.y),t.rotate(o.angle),t.beginPath(),t.moveTo(o.size,0),t.lineTo(-o.size*.7,o.size*.7),t.lineTo(-o.size*.4,0),t.lineTo(-o.size*.7,-o.size*.7),t.closePath(),t.strokeStyle="cyan",t.lineWidth=2,t.stroke(),E.ArrowUp&&(t.beginPath(),t.moveTo(-o.size*.5,0),t.lineTo(-o.size*.9,o.size*.4),t.lineTo(-o.size*1.2,0),t.lineTo(-o.size*.9,-o.size*.4),t.closePath(),t.fillStyle="orange",t.fill()),t.restore()}function le(){t.fillStyle="rgba(0, 0, 0, 0.85)",t.fillRect(0,0,r.width,r.height),t.fillStyle="white",t.font="32px Arial",t.textAlign="center",t.textBaseline="middle";let e=r.width/2,n=r.height/2-100,i=40;t.fillText("Controls",e,n),t.font="20px Arial",t.fillText("Arrow Left: Rotate Left",e,n+i*1.5),t.fillText("Arrow Right: Rotate Right",e,n+i*2.5),t.fillText("Arrow Up: Thrust",e,n+i*3.5),t.fillText("Spacebar: Shoot",e,n+i*4.5),t.fillText("?: Toggle Help / Pause",e,n+i*5.5),t.fillText("Esc: End Game",e,n+i*6.5),t.font="24px Arial",t.fillText("Press ? to close",e,n+i*8.5)}async function W(){q=!0,x=null;try{let e=await fetch("/api/leaderboard");if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);f=await e.json()}catch(e){console.error("Failed to fetch leaderboard:",e),x=e.message}finally{q=!1}}function $(){t.clearRect(0,0,r.width,r.height),t.fillStyle="black",t.fillRect(0,0,r.width,r.height),t.fillStyle="white",t.textAlign="center";let e=r.width/2,n=r.height*.15;t.font="84px Arial",t.textBaseline="middle",t.fillText("DINOSTROIDS",e,n);let i=n+100,s=i+40,c=25;t.font="32px Arial",t.fillText("TOP SCORES",e,i),t.font="16px Arial",t.textBaseline="top";let l=s;if(q)t.fillText("Loading...",e,s),l+=c;else if(x)t.fillText(`Error loading scores: ${x}`,e,s),l+=c;else if(f&&f.length>0){let u=e-180,m=e-100,I=e+50,z=e+110,A=s;t.textAlign="left",t.fillText("Rank",u,A),t.fillText("Initials",m,A),t.textAlign="right",t.fillText("Score",I+40,A),t.textAlign="left",t.fillText("Date",z,A),t.font="14px Arial",f.forEach((D,C)=>{if(C>=oe)return;let S=A+c*(C+1.5);t.textAlign="left",t.fillText(`${C+1}.`,u,S),t.fillText(D.initials,m,S),t.textAlign="right",t.fillText(D.score.toLocaleString(),I+40,S),t.textAlign="left";try{let O=new Date(D.createdAt),he=`${O.toLocaleDateString()} ${O.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`;t.fillText(he,z,S)}catch{t.fillText("Invalid Date",z,S)}l=S+c})}else t.fillText("No scores yet! Be the first!",e,s),l+=c;let a=l+60;t.textAlign="center",t.font="28px Arial",t.fillText("Start Game:",e,a),t.font="24px Arial",t.fillText("E)asy   M)edium   D)ifficult",e,a+40),t.font="20px Arial",t.textBaseline="bottom",t.fillText("? for Help",e,r.height-50),t.font="16px Arial",t.fillText("(c) Intensity Ventures, 2025",e,r.height-20)}function $e(e){L=e;let n=p[e];Ee=n.playerAcceleration,re=n.shootCooldown,Ie=n.asteroidMinSpeed,be=n.asteroidSpeedVariation,ke=n.initialAsteroidCountBase,K=n.lives,v=K,console.log(`Difficulty set to: ${e}`)}function Re(){if(g)return;g=!0,R=!0,y=0,T=1;let e=new AbortController,n=setTimeout(()=>e.abort(),3e3);fetch("/api/incrementGamesPlayed",{method:"POST",signal:e.signal,cache:"no-store"}).then(i=>{if(clearTimeout(n),i.ok)console.log("Successfully triggered server-side games played increment.");else throw console.error(`Failed to increment games played count on server. Status: ${i.status}`),new Error(`HTTP error! status: ${i.status}`)}).catch(i=>{i.name==="AbortError"?console.error("API request to increment games count timed out after 3 seconds"):console.error("Network error trying to increment games played count:",i)}),o.x=r.width/2,o.y=r.height/2,o.speed=0,o.angle=-Math.PI/2,d=[],h=[],de()}function ce(){console.log("Initializing game..."),r.width=window.innerWidth,r.height=window.innerHeight,window.addEventListener("resize",_e),Pe(()=>{console.log("Images loaded, initializing game..."),y=0,v=3,T=1,g=!1,w=!1,o.x=r.width/2,o.y=r.height/2,o.speed=0,o.angle=-Math.PI/2,d=[],h=[],$(),Promise.allSettled([(async()=>{try{await Oe()}catch(e){console.error("Failed to fetch games played:",e)}})(),(async()=>{try{await W()}catch(e){console.error("Failed to fetch leaderboard:",e)}})()]).then(()=>{g||$()})})}function de(){h=[],d=[];let e=5+T*2;console.log(`Level ${T}: Spawning ${e} asteroids.`);for(let n=0;n<e;n++)U("large");o.isInvulnerable=!0,setTimeout(()=>{o.isInvulnerable=!1},ie)}window.addEventListener("resize",()=>{r.width=window.innerWidth,r.height=window.innerHeight,o&&(o.x>r.width+o.size&&(o.x=r.width/2),o.y>r.height+o.size&&(o.y=r.height/2))});ce();requestAnimationFrame(M);function ze(){for(let e=h.length-1;e>=0;e--){let n=h[e],i=!1;R&&!o.isInvulnerable&&te(o,n)&&Ce();for(let s=d.length-1;s>=0;s--){let c=d[s];if(te(c,n)){d.splice(s,1),De(n,e),i=!0;break}}i||(n.update(),X(n))}}function De(e,n){switch(h.splice(n,1),e.sizeType){case"large":y+=20;for(let i=0;i<2;i++)U("medium",e.x,e.y);break;case"medium":y+=50;for(let i=0;i<2;i++)U("small",e.x,e.y);break;case"small":y+=100;break}h.length===0&&(T++,de())}function Ce(){if(!o.isInvulnerable){if(v--,v<=0){ae();return}o.x=r.width/2,o.y=r.height/2,o.speed=0,o.angle=-Math.PI/2,o.isInvulnerable=!0,setTimeout(()=>{o.isInvulnerable=!1},ie)}}async function Oe(){console.log("Fetching global games played count...");try{let e=new AbortController,n=setTimeout(()=>e.abort(),3e3),i=await fetch("/api/gamesPlayed",{signal:e.signal,cache:"no-store"});if(clearTimeout(n),!i.ok)throw console.warn(`API returned error status: ${i.status}`),new Error(`HTTP error! status: ${i.status}`);let s=await i.json();typeof s.count=="number"?(b=s.count,console.log(`Global games played count: ${b}`)):(console.warn("Received invalid count from API."),b=50)}catch(e){e.name==="AbortError"?console.error("API request timed out after 3 seconds"):console.error("Failed to fetch games played count:",e),b=50,console.log("Using fallback games played count: 50")}}function _e(){console.log("Resizing canvas to fit window..."),r.width=window.innerWidth,r.height=window.innerHeight,g?w&&le():$()}
