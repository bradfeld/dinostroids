var ge="@vercel/analytics",me="1.5.0",we=()=>{window.va||(window.va=function(...n){(window.vaq=window.vaq||[]).push(n)})};function K(){return typeof window<"u"}function Q(){try{let t="production";if(t==="development"||t==="test")return"development"}catch{}return"production"}function pe(t="auto"){if(t==="auto"){window.vam=Q();return}window.vam=t}function xe(){return(K()?window.vam:Q())||"production"}function Y(){return xe()==="development"}function ye(t){return t.scriptSrc?t.scriptSrc:Y()?"https://va.vercel-scripts.com/v1/script.debug.js":t.basePath?`${t.basePath}/insights/script.js`:"/_vercel/insights/script.js"}function j(t={debug:!0}){var n;if(!K())return;pe(t.mode),we(),t.beforeSend&&((n=window.va)==null||n.call(window,"beforeSend",t.beforeSend));let i=ye(t);if(document.head.querySelector(`script[src*="${i}"]`))return;let s=document.createElement("script");s.src=i,s.defer=!0,s.dataset.sdkn=ge+(t.framework?`/${t.framework}`:""),s.dataset.sdkv=me,t.disableAutoTrack&&(s.dataset.disableAutoTrack="1"),t.endpoint?s.dataset.endpoint=t.endpoint:t.basePath&&(s.dataset.endpoint=`${t.basePath}/insights`),t.dsn&&(s.dataset.dsn=t.dsn),s.onerror=()=>{let a=Y()?"Please check if any ad blockers are enabled and try again.":"Be sure to enable Web Analytics for your project and deploy again. See https://vercel.com/docs/analytics/quickstart for more information.";console.log(`[Vercel Web Analytics] Failed to load script from ${i}. ${a}`)},Y()&&t.debug===!1&&(s.dataset.debug="false"),document.head.appendChild(s)}j();var o=document.getElementById("gameCanvas"),e=o.getContext("2d");o.width=window.innerWidth;o.height=window.innerHeight;var k=Math.PI*2;var Te=20,Se=.07*3,$=.1,Ae=.98,se=3e3,ve=2,Ee=8,Ie=50,N=120,F=.6*3,V=1.6*3,ae={large:45,medium:25,small:15},H={easy:{large:{min:1.5,max:3},medium:{min:2.4,max:4.5},small:{min:3.6,max:6}},medium:{large:{min:2.4,max:4.5},medium:{min:3.6,max:6},small:{min:5.4,max:7.5}},difficult:{large:{min:3.6,max:6},medium:{min:5.4,max:7.5},small:{min:7.5,max:10.5}}},W=10,E={easy:{playerAcceleration:$*.67,shootCooldown:N,asteroidMinSpeed:F*.67,asteroidSpeedVariation:V*.67,initialAsteroidCountBase:2,lives:5},medium:{playerAcceleration:$*1,shootCooldown:Math.floor(N*.7),asteroidMinSpeed:F*1,asteroidSpeedVariation:V*.8,initialAsteroidCountBase:3,lives:3},difficult:{playerAcceleration:$*1.33,shootCooldown:Math.floor(N*.5),asteroidMinSpeed:F*1.33,asteroidSpeedVariation:V*1,initialAsteroidCountBase:4,lives:2}},z="medium",be=E.medium.playerAcceleration,le=E.medium.shootCooldown,Re=E.medium.asteroidMinSpeed,Le=E.medium.asteroidSpeedVariation,Me=E.medium.initialAsteroidCountBase,ee=E.medium.lives,X={BIG:"BIG",MEDIUM:"MEDIUM",LITTLE:"LITTLE"},Ve={[X.BIG]:{baseSize:45,score:20},[X.MEDIUM]:{baseSize:25,score:50},[X.LITTLE]:{baseSize:15,score:100}};var M={small:"images/bront.png",medium:"images/steg.png",large:"images/trex.png"},ce={},te=!1,P=0,ie=Object.keys(M).length;function De(t){console.log("Preloading images..."),Object.keys(M).forEach(n=>{let i=new Image;i.onload=()=>{console.log(`Image loaded: ${M[n]}`),P++,ce[n]=i,P===ie&&(console.log("All images successfully preloaded."),te=!0,t&&t())},i.onerror=()=>{console.error(`Failed to load image: ${M[n]}`),P++,P===ie&&(console.warn("Finished processing images, some failed to load."),te=!0,t&&t())},i.src=M[n]})}var r={x:o.width/2,y:o.height/2,angle:-Math.PI/2,speed:0,rotationSpeed:Se,acceleration:$,friction:Ae,size:Te,canShoot:!0,lastShotTime:0,isInvulnerable:!1},h=[],g=[],v=0,C=3,b=1,D=!0;var I=!1,w=!1,u=null,m=null,_=!1,q=class{constructor(n,i,s){this.sizeType=n,this.x=i,this.y=s,this.radius=ae[this.sizeType],this.size=this.radius,this.speed=Math.random()*(H[z][this.sizeType].max-H[z][this.sizeType].min)+H[z][this.sizeType].min,this.angle=Math.random()*k,this.rotation=Math.random()*k,this.rotationSpeed=(Math.random()-.5)*.05,this.image=ce[this.sizeType],this.image||console.error(`Image not loaded for sizeType: ${this.sizeType}. Asteroid may not render correctly.`)}draw(){if(this.x+this.radius<0||this.x-this.radius>o.width||this.y+this.radius<0||this.y-this.radius>o.height)return;if(!this.image){e.beginPath(),e.arc(this.x,this.y,this.radius,0,k),e.strokeStyle="grey",e.stroke();return}e.save(),e.translate(this.x,this.y),e.rotate(this.rotation);let n=this.image.naturalWidth/this.image.naturalHeight,i=this.radius*2,s,a;n>1?(s=i,a=i/n):(a=i,s=i*n);let l=-s/2,c=-a/2;e.drawImage(this.image,l,c,s,a),e.restore()}update(){this.x+=Math.cos(this.angle)*this.speed,this.y+=Math.sin(this.angle)*this.speed,this.rotation+=this.rotationSpeed,Z(this)}},U=class{constructor(n,i,s){this.x=n,this.y=i,this.angle=s,this.speed=Ee,this.radius=ve,this.size=this.radius,this.lifespan=Ie}draw(){this.x<-this.radius||this.x>o.width+this.radius||this.y<-this.radius||this.y>o.height+this.radius||(e.beginPath(),e.arc(this.x,this.y,this.radius,0,k),e.fillStyle="white",e.fill())}update(){return this.x+=Math.cos(this.angle)*this.speed,this.y+=Math.sin(this.angle)*this.speed,this.lifespan--,this.lifespan>0&&this.x>=-this.radius&&this.x<=o.width+this.radius&&this.y>=-this.radius&&this.y<=o.height+this.radius}},A={};document.addEventListener("keydown",t=>{if(A[t.key]=!0,t.key==="?"&&(I=!I,t.preventDefault()),!w&&!I){let n=t.key.toLowerCase(),i=null;n==="e"?i="easy":n==="m"?i="medium":n==="d"&&(i="difficult"),i&&(Oe(i),Ce(),t.preventDefault())}t.key==="Escape"&&w&&!I&&(D&&de(),t.preventDefault())});document.addEventListener("keyup",t=>{A[t.key]=!1});window.addEventListener("keydown",t=>{t.key==="Escape"&&w&&ke()});function Z(t){let n=typeof t.radius<"u"?t.radius:t.size;t.x<-n&&(t.x=o.width+n),t.x>o.width+n&&(t.x=-n),t.y<-n&&(t.y=o.height+n),t.y>o.height+n&&(t.y=-n)}function G(t="large",n=null,i=null){let s=ae[t],a=r.size+s+100;if(n===null||i===null){let c=0;do n=s+Math.random()*(o.width-2*s),i=s+Math.random()*(o.height-2*s),c++;while(c<50&&Math.sqrt(Math.pow(n-r.x,2)+Math.pow(i-r.y,2))<a);c>=50&&console.warn("Could not find a safe spawn location far from the player after 50 attempts. Spawning anyway."),console.log(`Spawning ${t} asteroid randomly inside canvas at (${n.toFixed(1)}, ${i.toFixed(1)})`)}else console.log(`Spawning split ${t} asteroid at provided location (${n.toFixed(1)}, ${i.toFixed(1)})`);let l=new q(t,n,i);g.push(l),console.log(`Asteroids array length: ${g.length}`)}function ne(t,n){let i=t.x-n.x,s=t.y-n.y,a=Math.sqrt(i*i+s*s),l=typeof t.radius<"u"?t.radius:t.size,c=typeof n.radius<"u"?n.radius:n.size;return a<l+c}async function de(){D=!1;let t=v;await re();let n=!1;u&&!m?u.length<W?n=t>0:n=t>u[u.length-1].score:m&&console.error("Cannot check leaderboard qualification due to fetch error.");let i=null,s=!1,a=null;if(n){for(;;){if(i=prompt(`You made the leaderboard! Score: ${t}
Enter your initials (1-3 characters):`),i===null){i=null;break}if(i=i.trim().toUpperCase(),i.length>0&&i.length<=3)break;alert("Please enter 1 to 3 characters for your initials.")}if(i)try{s=await Pe(i,t),s&&await re()}catch(p){a=p.message}}e.fillStyle="rgba(0, 0, 0, 0.85)",e.fillRect(0,0,o.width,o.height),e.fillStyle="white",e.textAlign="center",e.textBaseline="middle";let l=o.width/2,c=o.height/2;e.font="48px Arial",e.fillText("GAME OVER",l,c-150),e.font="30px Arial",e.fillText(`Final Score: ${t}`,l,c-100),e.font="20px Arial",n?i?s?e.fillText("Score submitted to leaderboard!",l,c-60):a?(e.fillText(`Submission Error: ${a}`,l,c-60),e.fillText("Your score was not saved.",l,c-30)):e.fillText("Score qualified, but was not submitted.",l,c-60):e.fillText("You qualified, but did not enter initials.",l,c-60):m?e.fillText("Could not check leaderboard ranking.",l,c-60):e.fillText("Better luck next time!",l,c-60),e.font="20px Arial",e.fillText("Returning to Title Screen...",l,c+150),setTimeout(()=>{J()},3e3)}async function Pe(t,n){console.log(`Submitting score: ${t} - ${n}`);try{let i=await fetch("/api/leaderboard",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({initials:t,score:n})});if(!i.ok){let a=await i.json().catch(()=>({message:"Unknown error"}));throw new Error(`Failed to submit score: ${i.status} ${a.message||""}`)}let s=await i.json();return console.log("Submission result:",s.message),!0}catch(i){throw console.error("Error submitting score:",i),i}}function ke(){console.log("Returning to main menu via Esc key..."),w=!1,D=!1,g=[],h=[],r.x=o.width/2,r.y=o.height/2,r.speed=0,r.angle=-Math.PI/2,r.canShoot=!0,v=0,b=1}async function O(t){if(I){fe(),requestAnimationFrame(O);return}if(!w){ze(),requestAnimationFrame(O);return}if(e.clearRect(0,0,o.width,o.height),e.fillStyle="black",e.fillRect(0,0,o.width,o.height),A.ArrowLeft&&(r.angle-=r.rotationSpeed),A.ArrowRight&&(r.angle+=r.rotationSpeed),A.ArrowUp?r.speed+=r.acceleration:r.speed*=r.friction,A[" "]&&r.canShoot){let i=r.x+Math.cos(r.angle)*r.size,s=r.y+Math.sin(r.angle)*r.size;h.push(new U(i,s,r.angle)),r.canShoot=!1,r.lastShotTime=t}!r.canShoot&&t-r.lastShotTime>le&&(r.canShoot=!0),r.x+=Math.cos(r.angle)*r.speed,r.y+=Math.sin(r.angle)*r.speed,Z(r);for(let i=h.length-1;i>=0;i--)h[i].update()||h.splice(i,1);_e(),e.fillStyle="white",e.font="20px Arial",e.textBaseline="top",e.textAlign="left",e.fillText("Level: "+b,10,10),e.textAlign="center",e.fillText("Score: "+v,o.width/2,10),e.textAlign="right",e.fillText("Lives: "+C,o.width-10,10),$e();for(let i of h)i.draw();let n=[];for(let i of g)n.push(i.draw());try{await Promise.all(n)}catch(i){console.error("Error during asteroid drawing batch:",i)}requestAnimationFrame(O)}function $e(){e.save(),e.translate(r.x,r.y),e.rotate(r.angle),e.beginPath(),e.moveTo(r.size,0),e.lineTo(-r.size*.7,r.size*.7),e.lineTo(-r.size*.4,0),e.lineTo(-r.size*.7,-r.size*.7),e.closePath(),e.strokeStyle="cyan",e.lineWidth=2,e.stroke(),A.ArrowUp&&(e.beginPath(),e.moveTo(-r.size*.5,0),e.lineTo(-r.size*.9,r.size*.4),e.lineTo(-r.size*1.2,0),e.lineTo(-r.size*.9,-r.size*.4),e.closePath(),e.fillStyle="orange",e.fill()),e.restore()}function fe(){e.fillStyle="rgba(0, 0, 0, 0.85)",e.fillRect(0,0,o.width,o.height),e.fillStyle="white",e.font="32px Arial",e.textAlign="center",e.textBaseline="middle";let t=o.width/2,n=o.height/2-100,i=40;e.fillText("Controls",t,n),e.font="20px Arial",e.fillText("Arrow Left: Rotate Left",t,n+i*1.5),e.fillText("Arrow Right: Rotate Right",t,n+i*2.5),e.fillText("Arrow Up: Thrust",t,n+i*3.5),e.fillText("Spacebar: Shoot",t,n+i*4.5),e.fillText("?: Toggle Help / Pause",t,n+i*5.5),e.fillText("Esc: End Game",t,n+i*6.5),e.font="24px Arial",e.fillText("Press ? to close",t,n+i*8.5)}async function re(){_=!0,m=null;try{let t=await fetch("/api/leaderboard");if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);u=await t.json()}catch(t){console.error("Failed to fetch leaderboard:",t),m=t.message}finally{_=!1}}function ze(){e.clearRect(0,0,o.width,o.height),e.fillStyle="black",e.fillRect(0,0,o.width,o.height),e.fillStyle="white",e.textAlign="center";let t=o.width/2,n=o.height*.15;e.font="84px Arial",e.textBaseline="middle",e.fillText("DINOSTROIDS",t,n);let i=n+100,s=i+40,a=25;e.font="32px Arial",e.fillText("TOP SCORES",t,i),e.font="16px Arial",e.textBaseline="top";let l=s;if(_)e.fillText("Loading...",t,s),l+=a;else if(m)e.fillText(`Error loading scores: ${m}`,t,s),l+=a;else if(u&&u.length>0){let p=t-180,R=t-100,L=t+50,x=t+110,f=s;e.textAlign="left",e.fillText("Rank",p,f),e.fillText("Initials",R,f),e.textAlign="right",e.fillText("Score",L+40,f),e.textAlign="left",e.fillText("Date",x,f),e.font="14px Arial",u.forEach((y,T)=>{if(T>=W)return;let d=f+a*(T+1.5);e.textAlign="left",e.fillText(`${T+1}.`,p,d),e.fillText(y.initials,R,d),e.textAlign="right",e.fillText(y.score.toLocaleString(),L+40,d),e.textAlign="left";try{let S=new Date(y.createdAt),B=`${S.toLocaleDateString()} ${S.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`;e.fillText(B,x,d)}catch{e.fillText("Invalid Date",x,d)}l=d+a})}else e.fillText("No scores yet! Be the first!",t,s),l+=a;let c=l+60;e.textAlign="center",e.font="28px Arial",e.fillText("Start Game:",t,c),e.font="24px Arial",e.fillText("E)asy   M)edium   D)ifficult",t,c+40),e.font="20px Arial",e.textBaseline="bottom",e.fillText("? for Help",t,o.height-50),e.font="16px Arial",e.fillText("(c) Intensity Ventures, 2025",t,o.height-20)}function Oe(t){z=t;let n=E[t];be=n.playerAcceleration,le=n.shootCooldown,Re=n.asteroidMinSpeed,Le=n.asteroidSpeedVariation,Me=n.initialAsteroidCountBase,ee=n.lives,C=ee,console.log(`Difficulty set to: ${t}`)}function Ce(){w||(w=!0,D=!0,v=0,b=1,r.x=o.width/2,r.y=o.height/2,r.speed=0,r.angle=-Math.PI/2,h=[],g=[],ue())}function oe(){console.log("Resizing canvas..."),o.width=window.innerWidth,o.height=window.innerHeight,I?fe():w||he()}function J(){console.log("Initializing game..."),oe(),window.addEventListener("resize",oe),De(()=>{console.log("Image preloading complete, proceeding with game setup."),he()})}function he(){e.clearRect(0,0,o.width,o.height),e.fillStyle="black",e.fillRect(0,0,o.width,o.height),e.fillStyle="white",e.textAlign="center";let t=o.width/2,n=o.height*.15;e.font="84px Arial",e.textBaseline="middle",e.fillText("DINOSTROIDS",t,n);let i=n+100,s=i+40,a=25;e.font="32px Arial",e.fillText("TOP SCORES",t,i),e.font="16px Arial",e.textBaseline="top";let l=s;if(_)e.fillText("Loading...",t,s),l+=a;else if(m)e.fillText(`Error loading scores: ${m}`,t,s),l+=a;else if(u&&u.length>0){let p=t-180,R=t-100,L=t+50,x=t+110,f=s;e.textAlign="left",e.fillText("Rank",p,f),e.fillText("Initials",R,f),e.textAlign="right",e.fillText("Score",L+40,f),e.textAlign="left",e.fillText("Date",x,f),e.font="14px Arial",u.forEach((y,T)=>{if(T>=W)return;let d=f+a*(T+1.5);e.textAlign="left",e.fillText(`${T+1}.`,p,d),e.fillText(y.initials,R,d),e.textAlign="right",e.fillText(y.score.toLocaleString(),L+40,d),e.textAlign="left";try{let S=new Date(y.createdAt),B=`${S.toLocaleDateString()} ${S.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`;e.fillText(B,x,d)}catch{e.fillText("Invalid Date",x,d)}l=d+a})}else e.fillText("No scores yet! Be the first!",t,s),l+=a;let c=l+60;e.textAlign="center",e.font="28px Arial",e.fillText("Start Game:",t,c),e.font="24px Arial",e.fillText("E)asy   M)edium   D)ifficult",t,c+40),e.font="20px Arial",e.textBaseline="bottom",e.fillText("? for Help",t,o.height-50),e.font="16px Arial",e.fillText("(c) Intensity Ventures, 2025",t,o.height-20)}function ue(){g=[],h=[];let t=5+b*2;console.log(`Level ${b}: Spawning ${t} asteroids.`);for(let n=0;n<t;n++)G("large");r.isInvulnerable=!0,setTimeout(()=>{r.isInvulnerable=!1},se)}window.addEventListener("resize",()=>{o.width=window.innerWidth,o.height=window.innerHeight,r&&(r.x>o.width+r.size&&(r.x=o.width/2),r.y>o.height+r.size&&(r.y=o.height/2))});J();requestAnimationFrame(O);function _e(){for(let t=g.length-1;t>=0;t--){let n=g[t],i=!1;D&&!r.isInvulnerable&&ne(r,n)&&Ye();for(let s=h.length-1;s>=0;s--){let a=h[s];if(ne(a,n)){h.splice(s,1),Be(n,t),i=!0;break}}i||(n.update(),Z(n))}}function Be(t,n){switch(g.splice(n,1),t.sizeType){case"large":v+=20;for(let i=0;i<2;i++)G("medium",t.x,t.y);break;case"medium":v+=50;for(let i=0;i<2;i++)G("small",t.x,t.y);break;case"small":v+=100;break}g.length===0&&(b++,ue())}function Ye(){if(!r.isInvulnerable){if(C--,C<=0){de();return}r.x=o.width/2,r.y=o.height/2,r.speed=0,r.angle=-Math.PI/2,r.isInvulnerable=!0,setTimeout(()=>{r.isInvulnerable=!1},se)}}J();
