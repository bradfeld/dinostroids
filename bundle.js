var Fe="@vercel/analytics",Ue="1.5.0",He=()=>{window.va||(window.va=function(...t){(window.vaq=window.vaq||[]).push(t)})};function he(){return typeof window<"u"}function ue(){try{let e="production";if(e==="development"||e==="test")return"development"}catch{}return"production"}function Ye(e="auto"){if(e==="auto"){window.vam=ue();return}window.vam=e}function Be(){return(he()?window.vam:ue())||"production"}function B(){return Be()==="development"}function ze(e){return e.scriptSrc?e.scriptSrc:B()?"https://va.vercel-scripts.com/v1/script.debug.js":e.basePath?`${e.basePath}/insights/script.js`:"/_vercel/insights/script.js"}function me(e={debug:!0}){var t;if(!he())return;Ye(e.mode),He(),e.beforeSend&&((t=window.va)==null||t.call(window,"beforeSend",e.beforeSend));let o=ze(e);if(document.head.querySelector(`script[src*="${o}"]`))return;let i=document.createElement("script");i.src=o,i.defer=!0,i.dataset.sdkn=Fe+(e.framework?`/${e.framework}`:""),i.dataset.sdkv=Ue,e.disableAutoTrack&&(i.dataset.disableAutoTrack="1"),e.endpoint?i.dataset.endpoint=e.endpoint:e.basePath&&(i.dataset.endpoint=`${e.basePath}/insights`),e.dsn&&(i.dataset.dsn=e.dsn),i.onerror=()=>{let n=B()?"Please check if any ad blockers are enabled and try again.":"Be sure to enable Web Analytics for your project and deploy again. See https://vercel.com/docs/analytics/quickstart for more information.";console.log(`[Vercel Web Analytics] Failed to load script from ${o}. ${n}`)},B()&&e.debug===!1&&(i.dataset.debug="false"),document.head.appendChild(i)}var m,D;function ge(){return m=document.getElementById("gameCanvas"),D=m.getContext("2d"),z(),{canvas:m,ctx:D}}function R(){return{canvas:m,ctx:D}}function z(){m&&(console.log("Resizing canvas to fit window..."),m.width=window.innerWidth,m.height=window.innerHeight)}function N(e="black"){!D||!m||(D.clearRect(0,0,m.width,m.height),D.fillStyle=e,D.fillRect(0,0,m.width,m.height))}function u(){return m?{width:m.width,height:m.height}:{width:0,height:0}}async function pe(){console.log("Fetching global games played count...");try{let e=new AbortController,t=setTimeout(()=>e.abort(),3e3),o=await fetch("/api/gamesPlayed",{signal:e.signal,cache:"no-store"});if(clearTimeout(t),!o.ok)throw console.warn(`API returned error status: ${o.status}`),new Error(`HTTP error! status: ${o.status}`);let i=await o.json();return typeof i.count=="number"?(console.log(`Global games played count: ${i.count}`),i.count):(console.warn("Received invalid count from API."),50)}catch(e){return e.name==="AbortError"?console.error("API request timed out after 3 seconds"):console.error("Failed to fetch games played count:",e),console.log("Using fallback games played count: 50"),50}}async function Se(){try{let e=new AbortController,t=setTimeout(()=>e.abort(),3e3),o=await fetch("/api/incrementGamesPlayed",{method:"POST",signal:e.signal,cache:"no-store"});return clearTimeout(t),o.ok?(console.log("Successfully triggered server-side games played increment."),!0):(console.error(`Failed to increment games played count on server. Status: ${o.status}`),!1)}catch(e){return e.name==="AbortError"?console.error("API request to increment games count timed out after 3 seconds"):console.error("Network error trying to increment games played count:",e),!1}}async function V(){console.log("Fetching leaderboard data...");try{let e=new AbortController,t=setTimeout(()=>e.abort(),5e3),o=await fetch("/api/leaderboard",{signal:e.signal,cache:"no-store",headers:{Accept:"application/json"}});if(clearTimeout(t),!o.ok)throw console.warn(`Leaderboard API returned error status: ${o.status}`),new Error(`HTTP error! status: ${o.status}`);let i=await o.json();return console.log("Leaderboard data received:",i.length?`${i.length} entries`:"Empty array"),i.length>0&&console.log("First entry:",JSON.stringify(i[0])),i}catch(e){return console.error("Failed to fetch leaderboard:",e),[]}finally{console.log("Leaderboard fetch completed")}}async function ye(e,t,o=0,i=1,n="medium"){console.log(`Submitting score: ${t} points, Level ${i}, ${o}ms, ${n} difficulty`);try{let r=await fetch("/api/leaderboard",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({initials:e,score:t,time:o,level:i,difficulty:n,date:new Date().toISOString()})});if(!r.ok){let l=await r.json().catch(()=>({message:"Unknown error"}));throw new Error(`Failed to submit score: ${r.status} ${l.message||""}`)}let s=await r.json();return console.log("Submission result:",s.message),!0}catch(r){return console.error("Error submitting score:",r),!1}}var U={FPS:60,INITIAL_LIVES:3,LEVEL_MULTIPLIER:.5,INITIAL_ASTEROIDS:4,ASTEROID_INCREMENT_PER_LEVEL:2,EXTRA_LIFE_SCORE_THRESHOLD:1e4,FRAME_DURATION:16.666666666666668,SPAWN_BUFFER:100},O={RADIUS:15,ROTATION_SPEED:4,ACCELERATION:200,FRICTION:.98,INVINCIBILITY_TIME:3e3,SHOOT_COOLDOWN:250},$={RADIUS:2,SPEED:500,LIFESPAN:1e3},I={BASE_RADIUS:50,SPEED_MULTIPLIER:50,ROTATION_SPEED:1,POINTS_BASE:100,COLLISION_DAMAGE:1,SPAWN_DISTANCE_MIN:100,SCORE_VALUES:{1:100,2:200,3:300},TYPES:["bront","steg","trex"]};var K={bront:"./images/bront.png",steg:"./images/steg.png",trex:"./images/trex.png"};var mt=Math.PI*2;var gt=.07*3,pt=.18*3;var St=.6*3,yt=1.6*3;var C={easy:{playerAcceleration:.54,shootCooldown:120,asteroidSpeed:{large:{min:1.5,max:3},medium:{min:2.4,max:4.5},small:{min:3.6,max:6}},initialAsteroids:2,lives:5},medium:{playerAcceleration:.81,shootCooldown:84,asteroidSpeed:{large:{min:2.4,max:4.5},medium:{min:3.6,max:6},small:{min:5.4,max:7.5}},initialAsteroids:3,lives:3},difficult:{playerAcceleration:1.08,shootCooldown:60,asteroidSpeed:{large:{min:3.6,max:6},medium:{min:5.4,max:7.5},small:{min:7.5,max:10.5}},initialAsteroids:4,lives:2}},W={BIG:"BIG",MEDIUM:"MEDIUM",LITTLE:"LITTLE"},Tt={[W.BIG]:{baseSize:45,score:20},[W.MEDIUM]:{baseSize:25,score:50},[W.LITTLE]:{baseSize:15,score:100}};var Te={};function Ee(e){return console.log("Preloading dinosaur images..."),new Promise((t,o)=>{let i=0,n=Object.keys(K).length;if(n===0){console.log("No dinosaur images to load."),e&&e(),t();return}let r=()=>{console.log("All dinosaur images loaded successfully!"),e&&e(),t()},s=a=>{console.log(`${a} dinosaur image loaded.`),i++,i===n&&r()},l=(a,c)=>{console.error(`Error loading ${a} dinosaur image:`,c),i++,i===n&&r()};Object.entries(K).forEach(([a,c])=>{let f=new Image;f.onload=()=>s(a),f.onerror=d=>l(a,d),f.src=c,Te[a]=f})})}function we(e){return Te[e]||null}var j={},X=null,q=null,Z=null,G=null;function Ae(){window.addEventListener("keydown",Ve),window.addEventListener("keyup",We)}function Ve(e){j[e.code]=!0,(e.code==="Enter"||e.code==="NumpadEnter")&&X&&X(),(e.key==="?"||e.code==="Slash"&&e.shiftKey)&&q&&(q(),e.preventDefault()),e.code==="Escape"&&Z&&Z(),G&&(e.code==="KeyE"?G("easy"):e.code==="KeyM"?G("medium"):e.code==="KeyD"&&G("difficult"))}function We(e){j[e.code]=!1}function F(e){return j[e]===!0}function J(e){X=e}function Q(e){q=e}function ee(e){Z=e}function te(e){G=e}var ie=class{constructor(){let{width:t,height:o}=u();this.x=t/2,this.y=o/2,this.radius=O.RADIUS,this.rotation=0,this.thrustPower=0,this.velocityX=0,this.velocityY=0,this.rotationSpeed=O.ROTATION_SPEED,this.acceleration=O.ACCELERATION,this.friction=O.FRICTION,this.canShoot=!0,this.shootCooldown=O.SHOOT_COOLDOWN,this.lastShot=0,this.isThrusting=!1,this.isDestroyed=!1,this.invincible=!1,this.invincibilityTime=0}update(t){if(this.isDestroyed)return null;if(this.invincible&&(this.invincibilityTime-=t*1e3,this.invincibilityTime<=0&&(this.invincible=!1,this.invincibilityTime=0)),F("ArrowLeft")&&(this.rotation-=this.rotationSpeed*t),F("ArrowRight")&&(this.rotation+=this.rotationSpeed*t),this.isThrusting=F("ArrowUp"),this.isThrusting){let r=Math.cos(this.rotation)*this.acceleration*t,s=Math.sin(this.rotation)*this.acceleration*t;this.velocityX+=r,this.velocityY+=s}this.velocityX*=this.friction,this.velocityY*=this.friction,this.x+=this.velocityX*t,this.y+=this.velocityY*t;let{width:o,height:i}=u();this.x<0&&(this.x=o),this.x>o&&(this.x=0),this.y<0&&(this.y=i),this.y>i&&(this.y=0);let n=null;if(F("Space")&&this.canShoot&&!this.isDestroyed){let r=Date.now();r-this.lastShot>this.shootCooldown&&(n={x:this.x+Math.cos(this.rotation)*this.radius,y:this.y+Math.sin(this.rotation)*this.radius,rotation:this.rotation},this.lastShot=r)}return n}draw(t){if(!this.isDestroyed&&!(this.invincible&&Math.floor(Date.now()/100)%2===0)){if(t.save(),t.translate(this.x,this.y),t.rotate(this.rotation),t.strokeStyle="white",t.lineWidth=2,t.beginPath(),t.moveTo(this.radius,0),t.lineTo(-this.radius*.7,-this.radius*.7),t.lineTo(-this.radius*.5,0),t.lineTo(-this.radius*.7,this.radius*.7),t.closePath(),t.stroke(),this.isThrusting){t.beginPath(),t.moveTo(-this.radius*.5,0),t.lineTo(-this.radius*1.5,0);let o=Math.random()*.5+.5;t.lineTo(-this.radius*(1+o),.5*this.radius*o),t.lineTo(-this.radius*.5,0),t.fillStyle="orange",t.fill()}t.restore()}}destroy(){this.isDestroyed=!0}reset(){let{width:t,height:o}=u();this.x=t/2,this.y=o/2,this.velocityX=0,this.velocityY=0,this.rotation=0,this.isDestroyed=!1,this.invincible=!0,this.invincibilityTime=O.INVINCIBILITY_TIME}isCollidingWith(t){if(this.isDestroyed||this.invincible)return!1;let o=this.x-t.x,i=this.y-t.y;return Math.sqrt(o*o+i*i)<this.radius+t.radius}},Ie=ie;function ve(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}function g(e,t){return Math.random()*(t-e)+e}var oe=class e{constructor(t,o,i,n,r="medium"){let{width:s,height:l}=u();this.type=t||this.getRandomType(),this.size=o||1,this.difficulty=r,this.radius=I.BASE_RADIUS/this.size,this.x=i!==void 0?i:g(0,s),this.y=n!==void 0?n:g(0,l);let a=this.getSizeCategory(),c=C[r].asteroidSpeed[a],f=g(c.min,c.max);this.velocityX=g(-1,1)*f,this.velocityY=g(-1,1)*f,this.rotation=0,this.rotationSpeed=g(-1,1)*I.ROTATION_SPEED;let d=this.getImageKey();this.image=we(d),this.points=I.POINTS_BASE*this.size}getSizeCategory(){switch(this.size){case 1:return"large";case 2:return"medium";case 3:return"small";default:return"large"}}getRandomType(){let t=["bront","steg","trex"];return t[ve(0,t.length-1)]}getImageKey(){return this.type}update(t){this.x+=this.velocityX,this.y+=this.velocityY,this.rotation+=this.rotationSpeed*t;let{width:o,height:i}=u();this.x<-this.radius&&(this.x=o+this.radius),this.x>o+this.radius&&(this.x=-this.radius),this.y<-this.radius&&(this.y=i+this.radius),this.y>i+this.radius&&(this.y=-this.radius)}draw(t){if(t.save(),t.translate(this.x,this.y),t.rotate(this.rotation),this.image){let o=this.radius*2/Math.max(this.image.width,this.image.height),i=this.image.width*o,n=this.image.height*o;t.drawImage(this.image,-i/2,-n/2,i,n)}else t.beginPath(),t.arc(0,0,this.radius,0,Math.PI*2),t.strokeStyle="gray",t.stroke();t.restore()}break(){if(this.size>=3)return[];let t=this.size+1,o=[];for(let i=0;i<2;i++){let n=g(-10,10),r=g(-10,10),s=new e(this.type,t,this.x+n,this.y+r,this.difficulty),l=s.getSizeCategory(),a=C[this.difficulty].asteroidSpeed[l],c=g(a.min,a.max),f=this.velocityX+g(-1,1),d=this.velocityY+g(-1,1),T=Math.sqrt(f*f+d*d);s.velocityX=f/T*c,s.velocityY=d/T*c,o.push(s)}return o}isCollidingWith(t){let o=this.x-t.x,i=this.y-t.y;return Math.sqrt(o*o+i*i)<this.radius+t.radius}},Le=oe;var ne=class{constructor(t,o,i){this.x=t,this.y=o,this.angle=i,this.velocityX=Math.cos(i)*$.SPEED,this.velocityY=Math.sin(i)*$.SPEED,this.radius=$.RADIUS,this.lifespan=$.LIFESPAN,this.active=!0}update(t){if(!this.active)return!1;if(this.x+=this.velocityX*t,this.y+=this.velocityY*t,this.lifespan-=t*1e3,this.lifespan<=0)return this.active=!1,!1;let{width:o,height:i}=u();return this.x<-this.radius||this.x>o+this.radius||this.y<-this.radius||this.y>i+this.radius?(this.active=!1,!1):!0}draw(t){this.active&&(t.beginPath(),t.arc(this.x,this.y,this.radius,0,Math.PI*2),t.fillStyle="white",t.fill())}isCollidingWith(t){if(!this.active)return!1;let o=this.x-t.x,i=this.y-t.y;return Math.sqrt(o*o+i*i)<this.radius+t.radius}deactivate(){this.active=!1}},xe=ne;function De(e,t,o,i,n){let{width:r,height:s}=u();e.fillStyle="white",e.font="20px Arial",e.textAlign="left",e.fillText(`Score: ${t}`,20,30),e.textAlign="center",e.fillText(`Level: ${i}`,r/2,30),Ke(e,o,r-20,30)}function Ke(e,t,o,i){for(let n=0;n<t;n++)Xe(e,o-n*25,i-5,10)}function Xe(e,t,o,i){e.save(),e.translate(t,o),e.rotate(-Math.PI/2),e.strokeStyle="white",e.lineWidth=1.5,e.beginPath(),e.moveTo(i,0),e.lineTo(-i*.7,-i*.7),e.lineTo(-i*.4,0),e.lineTo(-i*.7,i*.7),e.closePath(),e.stroke(),e.restore()}var E="",Oe=3,ae=!1,re=null,se=null;function le(e,t,o=[]){let{width:i,height:n}=u();if(N("black"),e.fillStyle="white",e.font="bold 48px Arial",e.textAlign="center",e.fillText("GAME OVER",i/2,n/4),e.font="32px Arial",e.fillText(`Score: ${t}`,i/2,n/4+60),Ze(t,o)){e.font="24px Arial",e.fillText("New High Score!",i/2,n/4+100),e.fillText("Enter your initials:",i/2,n/4+140);let s=40,l=40,a=10,c=s*3+a*2,f=i/2-c/2,d=n/4+160;for(let T=0;T<3;T++){let Y=f+T*(s+a);e.strokeStyle="white",e.lineWidth=2,e.strokeRect(Y,d,s,l),e.font="32px Arial",e.fillStyle="white",e.textAlign="center",T<E.length?e.fillText(E[T],Y+s/2,d+30):e.fillText("_",Y+s/2,d+30)}}else e.font="24px Arial",e.fillText("Press SPACE to play again",i/2,n/4+120);o&&o.length>0&&qe(e,o,i,n)}function qe(e,t,o,i){e.font="bold 32px Arial",e.fillText("TOP SCORES",o/2,i/2);let n=[...t].sort((s,l)=>l.score-s.score).slice(0,5);e.font="20px Arial",e.textAlign="left";let r=o/2-100;n.forEach((s,l)=>{let a=i/2+40+l*30;e.fillText(`${l+1}. ${s.initials}`,r,a),e.textAlign="right",e.fillText(`${s.score}`,r+200,a),e.textAlign="left"})}function Ze(e,t){if(!t||t.length===0||t.length<5)return!0;let o=[...t].sort((i,n)=>n.score-i.score);return e>o[4].score}function P(e){ae?e.key.length===1&&/[A-Za-z]/.test(e.key)?E.length<Oe&&(E+=e.key.toUpperCase(),E.length===Oe&&re&&setTimeout(()=>{re(E),je()},500)):e.key==="Backspace"&&(E=E.slice(0,-1)):e.code==="Space"&&se&&se()}function je(){E="",ae=!1}function Pe(){ae=!0,E=""}function be(e){re=e}function _e(e){se=e}function ce(e,t,o,i){let n=[...o].sort((s,l)=>l.score-s.score).slice(0,20),r=Math.min(n.length,20,Math.floor((i.canvas.height-t-50)/25));i.fillStyle="rgba(0, 0, 0, 0.5)",i.fillRect(e-200,t,400,r*25+50),i.fillStyle="white",i.font="bold 24px Arial",i.textAlign="center",i.fillText("High Scores",e,t+30),i.font="16px Arial",i.textAlign="left",i.fillText("Rank",e-180,t+60),i.fillText("Score",e-130,t+60),i.fillText("Difficulty",e-10,t+60),i.textAlign="right",i.fillText("Date",e+180,t+60),i.font="16px Arial";for(let s=0;s<r;s++){let l=n[s],a=t+85+s*25;l.isCurrent&&(i.fillStyle="rgba(255, 255, 0, 0.3)",i.fillRect(e-190,a-15,380,20),i.fillStyle="white"),i.textAlign="left",i.fillText(`${s+1}.`,e-180,a),i.fillText(`${l.score}`,e-130,a);let c=l.difficulty||"medium",f=c.charAt(0).toUpperCase()+c.slice(1);if(i.fillText(f,e-10,a),i.textAlign="right",l.date){let d=new Date(l.date),T=`${d.getMonth()+1}/${d.getDate()}/${d.getFullYear().toString().substr(2)}`;i.fillText(T,e+180,a)}else i.fillText("--/--/--",e+180,a)}o.length>r&&(i.textAlign="center",i.font="14px Arial",i.fillText(`Showing ${r} of ${o.length} scores`,e,t+r*25+40))}function Re(e,t,o=[],i=0){let{width:n,height:r}=u();e.fillStyle="white",e.font="bold 48px Arial",e.textAlign="center",e.fillText("DINOSTROIDS",n/2,r/3),e.font="24px Arial",e.fillText("Select Difficulty:",n/2,r/2-30);let s=[{key:"E",label:"Easy",value:"easy"},{key:"M",label:"Medium",value:"medium"},{key:"D",label:"Difficult",value:"difficult"}],l=r/2+30;s.forEach((a,c)=>{let f=n/2-150+c*150,d=t===a.value;d&&(e.fillStyle="rgba(255, 255, 255, 0.2)",e.fillRect(f-65,l-30,130,40)),e.fillStyle=d?"#ffff00":"white",e.fillText(`${a.key}: ${a.label}`,f,l)}),e.fillStyle="white",e.font="24px Arial",e.fillText("Press RETURN to start",n/2,r*2/3+20),e.fillText("Press ? for help",n/2,r*2/3+60),i>0&&(e.font="16px Arial",e.fillText(`Games Played: ${i}`,n/2,r-80)),e.font="14px Arial",e.fillText("\xA9 Intensity Ventures, 2025",n/2,r-20),o&&o.length>0&&ce(n-200,50,o,e)}var k=!1,S=!1,y=!1,b=!1,Je=!1,fe=0,_=0,H=U.INITIAL_LIVES,M=1,Ne=0,w=[],Qe=0;var x="medium",h=null,p=[],v=[],A=null,et,tt,it,ot,nt;function L(){let{ctx:e}=R();console.log("Showing start screen"),S=!1,b=!1,k=!1,document.removeEventListener("keydown",P),Me(),N("black"),Re(e,x,w,Ne)}function rt(){console.log("Game ended by user (ESC key)"),S=!1,y=!0,k=!1,A&&(cancelAnimationFrame(A),A=null),h=null,p=[],v=[],L()}function Ce(){let{canvas:e,ctx:t}=R();N("black"),t.fillStyle="white",t.font="bold 36px Arial",t.textAlign="center",t.fillText("HOW TO PLAY",e.width/2,100),t.font="20px Arial",t.textAlign="left";let o=["CONTROLS:","\u2022 Arrow Keys: Move ship","\u2022 Space: Fire","\u2022 ?: Toggle help screen","\u2022 ESC: End game and return to menu","","OBJECTIVE:","\u2022 Destroy all dinosaur asteroids","\u2022 Avoid collisions","\u2022 Score as many points as possible"],i=150,n=30;o.forEach((r,s)=>{t.fillText(r,e.width/4,i+s*n)}),t.font="24px Arial",t.textAlign="center",t.fillText("Press ? to return",e.width/2,e.height-50)}function Me(){ke(),J(()=>{console.log("Start key pressed"),!b&&!S&&st()}),Q(ct),ee(()=>{S&&!y&&rt()}),te(e=>{(!S||y)&&(x=e,ft(),L())})}function ke(){J(null),Q(null),ee(null),te(null)}function st(){if(b||S||y)return;console.log(`Starting game with ${x} difficulty...`),S=!0,y=!1,k=!0,_=0;let e=C[x];H=e.lives,M=1,h=new Ie,h.acceleration=e.playerAcceleration,h.shootCooldown=e.shootCooldown,$e(e.initialAsteroids),v=[],Se().catch(t=>console.error("Failed to increment games played:",t)),fe=performance.now(),A=requestAnimationFrame(de)}function $e(e){let{width:t,height:o}=u();p=[];for(let i=0;i<e;i++){let n,r,s;do{n=Math.random()*t,r=Math.random()*o;let a=h?h.x-n:t/2-n,c=h?h.y-r:o/2-r;s=Math.sqrt(a*a+c*c)}while(s<I.SPAWN_DISTANCE_MIN);let l=new Le(null,1,n,r,x);p.push(l)}}function de(e){let t=(e-fe)/1e3;if(fe=e,Je||!k){A=requestAnimationFrame(de);return}N("black");let{ctx:o,canvas:i}=R();if(h){let n=h.update(t);n&&v.push(new xe(n.x,n.y,n.rotation)),h.draw(o)}for(let n=v.length-1;n>=0;n--){let r=v[n];if(!r.update(t)){v.splice(n,1);continue}r.draw(o);for(let s=p.length-1;s>=0;s--){let l=p[s];if(r.isCollidingWith(l)){r.deactivate(),v.splice(n,1);let a=l.break();_+=I.SCORE_VALUES[l.size]||100,p.push(...a),p.splice(s,1);break}}}if(p.forEach(n=>{n.update(t),n.draw(o)}),h&&!h.isDestroyed)for(let n=p.length-1;n>=0;n--){let r=p[n];if(h.isCollidingWith(r)){h.destroy(),H-=I.COLLISION_DAMAGE,H<=0?at():setTimeout(()=>{h.reset()},1e3);break}}if(p.length===0&&S&&!y){M++;let n=Math.min(U.INITIAL_ASTEROIDS+(M-1)*U.ASTEROID_INCREMENT_PER_LEVEL,20);$e(n)}De(o,_,H,M,x),A=requestAnimationFrame(de)}function at(){console.log("Game over!"),y=!0,k=!1;let e=Qe;A&&(cancelAnimationFrame(A),A=null),h&&(h=null),p=[],v=[];let{ctx:t}=R();le(t,_,w,M,e),document.removeEventListener("keydown",P),lt()&&(Pe(),be(async i=>{try{await ye(i,_,e,M,x),w=await V(),document.removeEventListener("keydown",P),y=!1,S=!1,k=!1,L()}catch(n){console.error("Failed to submit score:",n),document.removeEventListener("keydown",P),y=!1,L()}})),document.addEventListener("keydown",P),_e(()=>{document.removeEventListener("keydown",P),y=!1,S=!1,ke(),L()})}function lt(){if(!w||w.length===0||w.length<10)return!0;let e=[...w].sort((t,o)=>o.score-t.score);return _>e[Math.min(9,e.length-1)].score}function ct(){S||(b=!b,b?Ce():L())}function Ge(){console.log("Initializing game...");let{canvas:e}=ge();window.addEventListener("resize",()=>{if(z(),!S)b?Ce():L();else if(y){let{ctx:t}=R();le(t,_,w)}}),Ae(),Me(),Ee(()=>{console.log("Images loaded, proceeding with game initialization..."),Promise.allSettled([(async()=>{try{Ne=await pe()}catch(t){console.error("Failed to fetch games played:",t)}})(),(async()=>{try{w=await V()}catch(t){console.error("Failed to fetch leaderboard:",t)}})()]).then(()=>{console.log("Game data loaded, showing start screen"),L()})})}function ft(){let e=C[x];et=e.playerAcceleration,tt=e.shootCooldown,it=e.asteroidSpeed,ot=e.initialAsteroids,nt=e.lives}me();document.addEventListener("DOMContentLoaded",()=>{Ge()});
